{% comment %}
  Subscribe and Save App Embed (Custom Widget)

  NOTE: This custom widget is DISABLED by default because Shopify's native
  selling plan UI is now working properly. Only enable this if you need
  a custom subscription selector that differs from Shopify's native UI.

  The native Shopify UI automatically appears when products are associated
  with a Selling Plan Group.
{% endcomment %}

{% if block.settings.enabled %}
  <div
    id="subscribe-save-embed"
    data-enabled="true"
    data-app-url="https://order-management-shopify-plugin-production.up.railway.app"
    data-shop-domain="{{ shop.permanent_domain }}"
    data-weekly-discount="{{ block.settings.weekly_discount }}"
    data-biweekly-discount="{{ block.settings.biweekly_discount }}"
    data-triweekly-discount="{{ block.settings.triweekly_discount }}"
    style="display: none;"
  ></div>
{% endif %}

{% schema %}
{
  "name": "Subscribe & Save (Custom)",
  "target": "body",
  "javascript": "subscribe-save.js",
  "stylesheet": "subscribe-save.css",
  "settings": [
    {
      "type": "checkbox",
      "id": "enabled",
      "label": "Enable Custom Subscribe & Save Widget",
      "default": false,
      "info": "Only enable if you need a custom widget. Shopify's native selling plan UI works automatically when products are in a Selling Plan Group."
    },
    {
      "type": "range",
      "id": "weekly_discount",
      "min": 1,
      "max": 50,
      "step": 1,
      "unit": "%",
      "label": "Weekly Subscription Discount",
      "default": 10
    },
    {
      "type": "range",
      "id": "biweekly_discount",
      "min": 1,
      "max": 50,
      "step": 1,
      "unit": "%",
      "label": "Bi-Weekly Subscription Discount",
      "default": 5
    },
    {
      "type": "range",
      "id": "triweekly_discount",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "%",
      "label": "Tri-Weekly (Every 3 Weeks) Discount",
      "default": 3,
      "info": "Set to 0 to hide this option"
    }
  ]
}
{% endschema %}
