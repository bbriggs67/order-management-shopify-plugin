{% comment %}
  Subscribe and Save App Embed
  Auto-injects subscription options on the cart page
  Works with SSMA (Susie's Sourdough Manager App) via cart attributes
{% endcomment %}

{% if block.settings.enabled %}
  {% if block.settings.dev_url != blank %}
    <meta name="subscribe-save-dev-url" content="{{ block.settings.dev_url }}">
  {% endif %}
  <div
    id="subscribe-save-embed"
    data-shop="{{ shop.permanent_domain }}"
    data-enabled="true"
    data-weekly-discount="{{ block.settings.weekly_discount }}"
    data-biweekly-discount="{{ block.settings.biweekly_discount }}"
    data-triweekly-discount="{{ block.settings.triweekly_discount }}"
    style="display: none;"
  ></div>
{% endif %}

{% schema %}
{
  "name": "Subscribe & Save",
  "target": "body",
  "javascript": "subscribe-save.js",
  "stylesheet": "subscribe-save.css",
  "settings": [
    {
      "type": "checkbox",
      "id": "enabled",
      "label": "Enable Subscribe & Save",
      "default": true,
      "info": "Shows subscription options on the cart page"
    },
    {
      "type": "range",
      "id": "weekly_discount",
      "min": 1,
      "max": 50,
      "step": 1,
      "unit": "%",
      "label": "Weekly Subscription Discount",
      "default": 10
    },
    {
      "type": "range",
      "id": "biweekly_discount",
      "min": 1,
      "max": 50,
      "step": 1,
      "unit": "%",
      "label": "Bi-Weekly Subscription Discount",
      "default": 5
    },
    {
      "type": "range",
      "id": "triweekly_discount",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "%",
      "label": "Tri-Weekly (Every 3 Weeks) Discount",
      "default": 3,
      "info": "Set to 0 to hide this option"
    },
    {
      "type": "text",
      "id": "dev_url",
      "label": "Development URL (optional)",
      "info": "For testing only - enter your cloudflare tunnel URL"
    }
  ]
}
{% endschema %}
